
/**
 * All browser know named colors
 */

export interface NamedColor {
    name: string,
    hex: string
}
export const NAMED_COLORS = [
    <NamedColor>{ name: 'White', hex: '#FFFFFF' },
    <NamedColor>{ name: 'Red', hex: '#FF0000' },
    <NamedColor>{ name: 'Orange', hex: '#FFA500' },
    <NamedColor>{ name: 'Yellow', hex: '#FFFF00' },
    <NamedColor>{ name: 'Green', hex: '#008000' },
    <NamedColor>{ name: 'Blue', hex: '#0000FF' },
    <NamedColor>{ name: 'Purple', hex: '#800080' },
    <NamedColor>{ name: 'Black', hex: '#000000' },
    <NamedColor>{ name: 'Alice Blue', hex: '#FOF8FF' },
    <NamedColor>{ name: 'Antique White', hex: '#FAEBD7' },
    <NamedColor>{ name: 'Aqua', hex: '#00FFFF' },
    <NamedColor>{ name: 'Aquamarine', hex: '#7FFFD4' },
    <NamedColor>{ name: 'Azure', hex: '#F0FFFF' },
    <NamedColor>{ name: 'Beige', hex: '#F5F5DC' },
    <NamedColor>{ name: 'Bisque', hex: '#FFE4C4' },
    <NamedColor>{ name: 'Blanched Almond', hex: '#FFEBCD' },
    <NamedColor>{ name: 'Blue Violet', hex: '#8A2BE2' },
    <NamedColor>{ name: 'Brown', hex: '#A52A2A' },
    <NamedColor>{ name: 'Burly Wood', hex: '#DEB887' },
    <NamedColor>{ name: 'Cadet Blue', hex: '#5F9EA0' },
    <NamedColor>{ name: 'Chartreuse', hex: '#7FFF00' },
    <NamedColor>{ name: 'Chocolate', hex: '#D2691E' },
    <NamedColor>{ name: 'Coral', hex: '#FF7F50' },
    <NamedColor>{ name: 'Corn Flower Blue', hex: '#6495ED' },
    <NamedColor>{ name: 'Corn Silk', hex: '#FFF8DC' },
    <NamedColor>{ name: 'Crimson', hex: '#DC143C' },
    <NamedColor>{ name: 'Cyan', hex: '#00FFFF' },
    <NamedColor>{ name: 'Dark Blue', hex: '#00008B' },
    <NamedColor>{ name: 'Dark Cyan', hex: '#008B8B' },
    <NamedColor>{ name: 'Dark Goldenrod', hex: '#B8860B' },
    <NamedColor>{ name: 'Dark Gray', hex: '#A9A9A9' },
    <NamedColor>{ name: 'Dark Green', hex: '#006400' },
    <NamedColor>{ name: 'Dark Khaki', hex: '#BDB76B' },
    <NamedColor>{ name: 'Dark Magenta', hex: '#BD008B' },
    <NamedColor>{ name: 'Dark Olive Green', hex: '#556B2F' },
    <NamedColor>{ name: 'Dark Orange', hex: '#FF8C00' },
    <NamedColor>{ name: 'Dark Orchid', hex: '#9932CC' },
    <NamedColor>{ name: 'Dark Red', hex: '#8B0000' },
    <NamedColor>{ name: 'Dark Salmon', hex: '#E9967A' },
    <NamedColor>{ name: 'Dark Sea Green', hex: '#8FBC8F' },
    <NamedColor>{ name: 'Dark Slate Blue', hex: '#483D8B' },
    <NamedColor>{ name: 'Dark Slate Gray', hex: '#2F4F4F' },
    <NamedColor>{ name: 'Dark Turquoise', hex: '#00CED1' },
    <NamedColor>{ name: 'Dark Violet', hex: '#9400D3' },
    <NamedColor>{ name: 'Deep Pink', hex: '#FF1493' },
    <NamedColor>{ name: 'Deep Sky Blue', hex: '#00BFFF' },
    <NamedColor>{ name: 'Dim Gray', hex: '#696969' },
    <NamedColor>{ name: 'Dodger Blue', hex: '#1E90FF' },
    <NamedColor>{ name: 'Fire Brick', hex: '#B22222' },
    <NamedColor>{ name: 'Floral White', hex: '#FFFAF0' },
    <NamedColor>{ name: 'Forest Green', hex: '#228B22' },
    <NamedColor>{ name: 'Fuschia', hex: '#FF00FF' },
    <NamedColor>{ name: 'Gainsboro', hex: '#DCDCDC' },
    <NamedColor>{ name: 'Ghost White', hex: '#F8F8FF' },
    <NamedColor>{ name: 'Gold', hex: '#FFD700' },
    <NamedColor>{ name: 'Goldenrod', hex: '#DAA520' },
    <NamedColor>{ name: 'Gray', hex: '#808080' },
    <NamedColor>{ name: 'Green Yellow', hex: '#ADFF2F' },
    <NamedColor>{ name: 'Honeydew', hex: '#F0FFF0' },
    <NamedColor>{ name: 'Hot Pink', hex: '#FF69B4' },
    <NamedColor>{ name: 'Indian Red', hex: '#CD5C5C' },
    <NamedColor>{ name: 'Indigo', hex: '#4B0082' },
    <NamedColor>{ name: 'Ivory', hex: '#FFFFF0' },
    <NamedColor>{ name: 'Khaki', hex: '#F0E68C' },
    <NamedColor>{ name: 'Lavender', hex: '#E6E6FA' },
    <NamedColor>{ name: 'Lavender Blush', hex: '#FFF0F5' },
    <NamedColor>{ name: 'Lemon Chiffon', hex: '#FFFACD' },
    <NamedColor>{ name: 'Light Blue', hex: '#ADD8E6' },
    <NamedColor>{ name: 'Light Coral', hex: '#F08080' },
    <NamedColor>{ name: 'Light Cyan', hex: '#E0FFFF' },
    <NamedColor>{ name: 'Light Goldenrod Yellow', hex: '#FAFAD2' },
    <NamedColor>{ name: 'Light Green', hex: '#90EE90' },
    <NamedColor>{ name: 'Light Grey', hex: '#D3D3D3' },
    <NamedColor>{ name: 'Light Pink', hex: '#FFB6C1' },
    <NamedColor>{ name: 'Light Salmon', hex: '#FFA07A' },
    <NamedColor>{ name: 'Light Sea Green', hex: '#20B2AA' },
    <NamedColor>{ name: 'Light Sky Blue', hex: '#87CEFA' },
    <NamedColor>{ name: 'Light Slate Gray', hex: '#778899' },
    <NamedColor>{ name: 'Light Steel Blue', hex: '#B0C4DE' },
    <NamedColor>{ name: 'Light Yellow', hex: '#FFFFE0' },
    <NamedColor>{ name: 'Lime', hex: '#00FF00' },
    <NamedColor>{ name: 'Lime Green', hex: '#32CD32' },
    <NamedColor>{ name: 'Linen', hex: '#FAF0E6' },
    <NamedColor>{ name: 'Magenta', hex: '#FF00FF' },
    <NamedColor>{ name: 'Maroon', hex: '#800000' },
    <NamedColor>{ name: 'Medium Aquamarine', hex: '#66CDAA' },
    <NamedColor>{ name: 'Medium Blue', hex: '#0000CD' },
    <NamedColor>{ name: 'Medium Orchid', hex: '#BA55D3' },
    <NamedColor>{ name: 'Medium Purple', hex: '#9370DB' },
    <NamedColor>{ name: 'Medium Sea Green', hex: '#3CB371' },
    <NamedColor>{ name: 'Medium Slate Blue', hex: '#7B68EE' },
    <NamedColor>{ name: 'Medium Spring Green', hex: '#00FA9A' },
    <NamedColor>{ name: 'Medium Turquoise', hex: '#48D1CC' },
    <NamedColor>{ name: 'Medium Violet Red', hex: '#C71585' },
    <NamedColor>{ name: 'Midnight Blue', hex: '#191970' },
    <NamedColor>{ name: 'Mint Cream', hex: '#F5FFFA' },
    <NamedColor>{ name: 'Misty Rose', hex: '#FFE4E1' },
    <NamedColor>{ name: 'Navajo White', hex: '#FFDEAD' },
    <NamedColor>{ name: 'Navy', hex: '#000080' },
    <NamedColor>{ name: 'Old Lace', hex: '#FDF5E6' },
    <NamedColor>{ name: 'Olive', hex: '#808000' },
    <NamedColor>{ name: 'Olive Drab', hex: '#6B8E23' },
    <NamedColor>{ name: 'Orange Red', hex: '#FF4500' },
    <NamedColor>{ name: 'Orchid', hex: '#DA70D6' },
    <NamedColor>{ name: 'Pale Goldenrod', hex: '#EEE8AA' },
    <NamedColor>{ name: 'Pale Green', hex: '#98FB98' },
    <NamedColor>{ name: 'Pale Turquoise', hex: '#AFEEEE' },
    <NamedColor>{ name: 'Pale Violet Red', hex: '#DB7093' },
    <NamedColor>{ name: 'Papaya Whip', hex: '#FFEFD5' },
    <NamedColor>{ name: 'Peach Puff', hex: '#FFDAB9' },
    <NamedColor>{ name: 'Peru', hex: '#CD853F' },
    <NamedColor>{ name: 'Pink', hex: '#FFC0CB' },
    <NamedColor>{ name: 'Plum', hex: '#DDA0DD' },
    <NamedColor>{ name: 'Powder Blue', hex: '#B0E0E6' },
    <NamedColor>{ name: 'Rosy Brown', hex: '#BC8F8F' },
    <NamedColor>{ name: 'Royal Blue', hex: '#4169E1' },
    <NamedColor>{ name: 'Saddle Brown', hex: '#8B4513' },
    <NamedColor>{ name: 'Sea Green', hex: '#2E8B57' },
    <NamedColor>{ name: 'Sea Shell', hex: '#FFF5EE' },
    <NamedColor>{ name: 'Sienna', hex: '#A0522D' },
    <NamedColor>{ name: 'Silver', hex: '#C0C0C0' },
    <NamedColor>{ name: 'Sky Blue', hex: '#87CEEB' },
    <NamedColor>{ name: 'Slate Blue', hex: '#6A5ACD' },
    <NamedColor>{ name: 'Slate Gray', hex: '#708090' },
    <NamedColor>{ name: 'Snow', hex: '#FFFAFA' },
    <NamedColor>{ name: 'Spring Green', hex: '#00FF7F' },
    <NamedColor>{ name: 'Steel Blue', hex: '#4682B4' },
    <NamedColor>{ name: 'Tan', hex: '#D2B486' },
    <NamedColor>{ name: 'Teal', hex: '#008080' },
    <NamedColor>{ name: 'Thistle', hex: '#D8BFDB' },
    <NamedColor>{ name: 'Tomato', hex: '#FF6347' },
    <NamedColor>{ name: 'Turquoise', hex: '#40E0D0' },
    <NamedColor>{ name: 'Violet', hex: '#EE82EE' },
    <NamedColor>{ name: 'Wheat', hex: '#F5DEB3' },
    <NamedColor>{ name: 'White Smoke', hex: '#F5F5F5' },
    <NamedColor>{ name: 'Yellow Green', hex: '#9ACD32' }
] 
export class ColorHandler {

    

    /**
     * Function that calculate the color shadows, and return the requested tone
     */
    public static getColorTone(colorHex: string, colorTone: number) {
        if (!colorHex.startsWith("#")) return null;

        let r = this.getBaseColor(colorHex, 'r');
        let g = this.getBaseColor(colorHex, 'g');
        let b = this.getBaseColor(colorHex, 'b');

        let percentage;
        switch (colorTone){
            case 0: percentage = 5; break;
            case 1: percentage = 4; break;
            case 2: percentage = 3; break;
            case 3: percentage = 2; break;
            case 4: percentage = 1; break; 
            case 6: percentage = 1; break;
            case 7: percentage = 2; break;
            case 8: percentage = 3; break;
            case 9: percentage = 4; break;
            case 10: percentage = 5; break;
        }

        if(colorTone < 5){
            return ColorHandler.RGBToHSL(r, g, b, percentage, true);
        }
        else if (colorTone > 5){
            return ColorHandler.RGBToHSL(r, g, b, percentage, false);
        }
        else return colorHex;

    }

    public static getBaseColor(hex: string, key: 'r' | 'g' | 'b') {
        hex = hex.replace('#', '');
        switch (key) {
            case 'r': return parseInt(hex.substring(0, 2), 16);
            case 'g': return parseInt(hex.substring(2, 4), 16);
            case 'b': return parseInt(hex.substring(4, 6), 16);
        }
    }

    public static RGBToHSL(r, g, b, value, invert) {
        // Make r, g, and b fractions of 1
        r /= 255;
        g /= 255;
        b /= 255;

        // Find greatest and smallest channel values
        let cmin = Math.min(r, g, b),
            cmax = Math.max(r, g, b),
            delta = cmax - cmin,
            h = 0,
            s = 0,
            l = 0;

        if (delta == 0)
            h = 0;
        // Red is max
        else if (cmax == r)
            h = ((g - b) / delta) % 6;
        // Green is max
        else if (cmax == g)
            h = (b - r) / delta + 2;
        // Blue is max
        else
            h = (r - g) / delta + 4;

        h = Math.round(h * 60);

        // Make negative hues positive behind 360Â°
        if (h < 0)
            h += 360;

        l = (cmax + cmin) / 2;

        // Calculate saturation
        s = delta == 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));

        // Multiply l and s by 100
        s = +(s * 100).toFixed(1);
        l = +(l * 100).toFixed(1);

        if (invert)
            return ColorHandler.hslToHex(h, s, (l += 6 * value));
        else
            return ColorHandler.hslToHex(h, s, (l -= 6 * value));
    }

    private static hslToHex(h, s, l) {
        h /= 360;
        s /= 100;
        l /= 100;
        let r, g, b;
        if (s === 0) {
          r = g = b = l; // achromatic
        } else {
          const hue2rgb = (p, q, t) => {
            if (t < 0) t += 1;
            if (t > 1) t -= 1;
            if (t < 1 / 6) return p + (q - p) * 6 * t;
            if (t < 1 / 2) return q;
            if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
            return p;
          };
          const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
          const p = 2 * l - q;
          r = hue2rgb(p, q, h + 1 / 3);
          g = hue2rgb(p, q, h);
          b = hue2rgb(p, q, h - 1 / 3);
        }
        const toHex = x => {
          const hex = Math.round(x * 255).toString(16);
          return hex.length === 1 ? '0' + hex : hex;
        };
        return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
      }
}